<div class="products-container">
  <div class="header">
    <div>
      <h2>{{ 'common.products.title' | transloco }}</h2>
      <p class="subtitle">{{ 'common.dashboard.products_desc' | transloco }}</p>
    </div>
    <div class="toolbar">
      <button mat-flat-button
        color="primary"
        (click)="openAdd()">
        {{ 'common.products.add' | transloco }}
        <mat-icon iconPositionEnd>add</mat-icon>
      </button>
    </div>
  </div>

  <div class="table-card">
    @if (productService.isLoading()) {
    <div class="skeleton-wrapper">
      <div class="skeleton-header">
        <div style="width: 36px;">{{ 'common.products.image' | transloco }}</div>
        <div style="flex: 1; max-width: 200px;">{{ 'common.products.name' | transloco }}</div>
        <div style="flex: 2;">{{ 'common.products.description' | transloco }}</div>
        <div style="width: 80px;">{{ 'common.products.price' | transloco }}</div>
        <div style="width: 80px; text-align: right;">{{ 'common.products.actions' | transloco }}</div>
      </div>
      @for (i of [1,2,3,4,5]; track i) {
      <div class="skeleton-row">
        <div class="skeleton skeleton-image"></div>
        <div class="skeleton skeleton-text"
          style="width: 20%"></div>
        <div class="skeleton skeleton-text"
          style="width: 40%"></div>
        <div class="skeleton skeleton-pill"></div>
        <div class="skeleton skeleton-actions"></div>
      </div>
      }
    </div>
    } @else {
    <div class="table-wrapper">
      <table mat-table
        [dataSource]="dataSource"
        class="products-table "
        aria-label="Products list">
        <ng-container matColumnDef="image">
          <th mat-header-cell
            *matHeaderCellDef>{{ 'common.products.image' | transloco }}</th>
          <td mat-cell
            *matCellDef="let p">
            <div class="image-wrap">
              <img [ngSrc]="p?.imageUrl"
                width="36"
                height="36"
                alt="{{ p.name }}" />
            </div>
          </td>
        </ng-container>
        <ng-container matColumnDef="name">
          <th mat-header-cell
            *matHeaderCellDef>{{ 'common.products.name' | transloco }}</th>
          <td mat-cell
            *matCellDef="let p">
            <div class="name-cell">{{ p.name }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th mat-header-cell
            *matHeaderCellDef>{{ 'common.products.description' | transloco }}</th>
          <td mat-cell
            *matCellDef="let p">
            <div class="desc-cell">{{ p.description }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="price">
          <th mat-header-cell
            *matHeaderCellDef>{{ 'common.products.price' | transloco }}</th>
          <td mat-cell
            *matCellDef="let p">
            <span class="price-pill">{{ p.price | number: '1.2-2' }} $</span>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell
            *matHeaderCellDef
            class="actions-header">{{ 'common.products.actions' | transloco }}</th>
          <td mat-cell
            *matCellDef="let p"
            class="actions-cell">
            <div class="action-icons">
              <mat-icon [attr.aria-label]="'common.products.edit_aria' | transloco"
                (click)="openEdit(p)"
                role="button"
                tabindex="0">edit</mat-icon>
              <mat-icon [attr.aria-label]="'common.products.delete_aria' | transloco"
                (click)="deleteProduct(p.id)"
                role="button"
                tabindex="0">delete</mat-icon>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row
          *matHeaderRowDef="['image', 'name', 'description', 'price', 'actions']"></tr>
        <tr mat-row
          *matRowDef="let row; columns: ['image', 'name', 'description', 'price', 'actions']"></tr>
      </table>
    </div>
    <mat-paginator [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
      aria-label="Select page of products"
      class="products-paginator">
    </mat-paginator>
    }
  </div>
</div>